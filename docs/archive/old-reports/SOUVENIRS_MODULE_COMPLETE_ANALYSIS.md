# üéÅ –ü–û–õ–ù–´–ô –ê–ù–ê–õ–ò–ó –ú–û–î–£–õ–Ø –°–£–í–ï–ù–ò–†–û–í - KAMCHATOUR HUB

**–î–∞—Ç–∞ –∞–Ω–∞–ª–∏–∑–∞:** 2025-11-12  
**–í–µ—Ä—Å–∏—è:** 1.0  
**–°—Ç–∞—Ç—É—Å:** Complete Module Analysis  
**–í–µ—Ç–∫–∞:** `cursor/bc-6746a212-ca75-4653-b1b4-40c07270c0d2-614b` (—Ç–µ–∫—É—â–∞—è)

---

## üìä EXECUTIVE SUMMARY

**–ú–æ–¥—É–ª—å "–°—É–≤–µ–Ω–∏—Ä—ã –ö–∞–º—á–∞—Ç–∫–∏"** - —ç—Ç–æ –ø–æ–ª–Ω–æ—Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π **e-commerce –º–∞–≥–∞–∑–∏–Ω** –≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π –≤ —ç–∫–æ—Å–∏—Å—Ç–µ–º—É Kamchatour Hub.

### –ö–ª—é—á–µ–≤—ã–µ –ø–æ–∫–∞–∑–∞—Ç–µ–ª–∏:

```
üì¶ –í—Å–µ–≥–æ –∫–æ–¥–∞:             789 —Å—Ç—Ä–æ–∫
üìÑ TypeScript —Ñ–∞–π–ª–æ–≤:      7 —Ñ–∞–π–ª–æ–≤
üóÑÔ∏è SQL —Å—Ö–µ–º:               2 —Ñ–∞–π–ª–∞ (6 —Ç–∞–±–ª–∏—Ü)
‚öõÔ∏è React –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤:      4 –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞
üîó API endpoints:          3 endpoint'–∞
üì± UI views:               3 –≤–∏–¥–∞ (catalog, cart, checkout)
‚úÖ –ì–æ—Ç–æ–≤–Ω–æ—Å—Ç—å:             85% (—Ç—Ä–µ–±—É–µ—Ç –¥–æ—Ä–∞–±–æ—Ç–∫–∏)
```

---

## üèóÔ∏è 1. –ê–†–•–ò–¢–ï–ö–¢–£–†–ê –ú–û–î–£–õ–Ø

### 1.1 –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ñ–∞–π–ª–æ–≤

```
üì¶ Souvenir Module
‚îú‚îÄ‚îÄ üìÇ types/
‚îÇ   ‚îî‚îÄ‚îÄ souvenirs.ts (376 —Å—Ç—Ä–æ–∫) ..................... TypeScript —Ç–∏–ø—ã
‚îú‚îÄ‚îÄ üìÇ app/
‚îÇ   ‚îú‚îÄ‚îÄ hub/souvenirs/page.tsx (268 —Å—Ç—Ä–æ–∫) ........... –ì–ª–∞–≤–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ –º–∞–≥–∞–∑–∏–Ω–∞
‚îÇ   ‚îî‚îÄ‚îÄ api/souvenirs/route.ts (167 —Å—Ç—Ä–æ–∫) ........... API endpoint
‚îú‚îÄ‚îÄ üìÇ components/souvenirs/
‚îÇ   ‚îú‚îÄ‚îÄ SouvenirCard.tsx (53 —Å—Ç—Ä–æ–∫–∏) ................. –ö–∞—Ä—Ç–æ—á–∫–∞ —Ç–æ–≤–∞—Ä–∞
‚îÇ   ‚îú‚îÄ‚îÄ ShoppingCart.tsx (119 —Å—Ç—Ä–æ–∫) ................. –ö–æ—Ä–∑–∏–Ω–∞
‚îÇ   ‚îú‚îÄ‚îÄ SouvenirCheckout.tsx (296 —Å—Ç—Ä–æ–∫) ............. –û—Ñ–æ—Ä–º–ª–µ–Ω–∏–µ –∑–∞–∫–∞–∑–∞
‚îÇ   ‚îî‚îÄ‚îÄ SouvenirFilters.tsx (–Ω–µ–∏–∑–≤–µ—Å—Ç–Ω–æ) ............. –§–∏–ª—å—Ç—Ä—ã
‚îú‚îÄ‚îÄ üìÇ lib/database/
‚îÇ   ‚îî‚îÄ‚îÄ souvenirs_schema.sql (145 —Å—Ç—Ä–æ–∫) ............. SQL —Å—Ö–µ–º–∞
‚îî‚îÄ‚îÄ üìÇ tests/
    ‚îî‚îÄ‚îÄ api/souvenirs.test.ts ........................ Unit —Ç–µ—Å—Ç—ã
```

**Total Lines of Code:** ~1200+ —Å—Ç—Ä–æ–∫

---

## üì¶ 2. –°–£–©–ù–û–°–¢–ò –ò –¢–ò–ü–´

### 2.1 Core Entities (15 —Ç–∏–ø–æ–≤)

#### üéÅ 1. SOUVENIR (–¢–æ–≤–∞—Ä)

```typescript
interface Souvenir {
  // –û—Å–Ω–æ–≤–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è
  id: string;
  name: string;
  description: string;
  shortDescription?: string;
  
  // –ö–∞—Ç–µ–≥–æ—Ä–∏–∑–∞—Ü–∏—è
  category: SouvenirCategory; // 12 –∫–∞—Ç–µ–≥–æ—Ä–∏–π
  subcategory?: string;
  tags: string[];
  
  // –¶–µ–Ω–æ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ
  price: number;
  currency: string;
  discountPrice?: number;
  
  // –ú–µ–¥–∏–∞
  images: string[]; // –º–∞—Å—Å–∏–≤ URL
  videoUrl?: string;
  
  // –ù–∞–ª–∏—á–∏–µ
  stockQuantity: number;
  lowStockThreshold: number;
  isActive: boolean;
  isFeatured: boolean;
  
  // –§–∏–∑–∏—á–µ—Å–∫–∏–µ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏
  weight?: number; // –∫–≥
  dimensions?: {
    length: number;
    width: number;
    height: number;
  };
  
  // –î–µ—Ç–∞–ª–∏ –ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–∞
  materials?: string[];
  origin: string; // —Å—Ç—Ä–∞–Ω–∞/—Ä–µ–≥–∏–æ–Ω
  artisan?: string; // –º–∞—Å—Ç–µ—Ä
  
  // –°–æ—Ü–∏–∞–ª—å–Ω–æ–µ –¥–æ–∫–∞–∑–∞—Ç–µ–ª—å—Å—Ç–≤–æ
  rating: number;
  reviewCount: number;
  salesCount: number;
  
  // Timestamps
  createdAt: Date;
  updatedAt: Date;
}
```

**12 –∫–∞—Ç–µ–≥–æ—Ä–∏–π:**
1. `traditional_art` - –¢—Ä–∞–¥–∏—Ü–∏–æ–Ω–Ω–æ–µ –∏—Å–∫—É—Å—Å—Ç–≤–æ
2. `jewelry` - –£–∫—Ä–∞—à–µ–Ω–∏—è
3. `textiles` - –¢–µ–∫—Å—Ç–∏–ª—å
4. `ceramics` - –ö–µ—Ä–∞–º–∏–∫–∞
5. `woodwork` - –ò–∑–¥–µ–ª–∏—è –∏–∑ –¥–µ—Ä–µ–≤–∞
6. `leather` - –ö–æ–∂–∞–Ω—ã–µ –∏–∑–¥–µ–ª–∏—è
7. `food_drinks` - –ï–¥–∞ –∏ –Ω–∞–ø–∏—Ç–∫–∏
8. `books` - –ö–Ω–∏–≥–∏
9. `clothing` - –û–¥–µ–∂–¥–∞
10. `decorations` - –î–µ–∫–æ—Ä
11. `toys` - –ò–≥—Ä—É—à–∫–∏
12. `cosmetics` - –ö–æ—Å–º–µ—Ç–∏–∫–∞

---

#### üõí 2. CART & CART_ITEM (–ö–æ—Ä–∑–∏–Ω–∞)

```typescript
interface ShoppingCart {
  id: string;
  userId?: string; // –¥–ª—è –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã—Ö
  sessionId: string; // –¥–ª—è –≥–æ—Å—Ç–µ–π
  items: CartItem[];
  
  // –¶–µ–Ω–æ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ
  subtotal: number; // —Å—É–º–º–∞ –±–µ–∑ —Å–∫–∏–¥–æ–∫
  discountAmount: number;
  taxAmount: number;
  shippingCost: number;
  total: number;
  currency: string;
  
  // –ö—É–ø–æ–Ω—ã
  couponCode?: string;
  couponDiscount?: number;
  
  createdAt: Date;
  updatedAt: Date;
}

interface CartItem {
  souvenirId: string;
  souvenir: Souvenir;
  quantity: number;
  selectedOptions?: ProductOption[]; // —Ü–≤–µ—Ç, —Ä–∞–∑–º–µ—Ä –∏ —Ç.–¥.
  
  // –ü–æ–¥–∞—Ä–æ—á–Ω–∞—è —É–ø–∞–∫–æ–≤–∫–∞
  giftMessage?: string;
  giftWrap?: boolean;
  
  unitPrice: number;
  totalPrice: number;
  addedAt: Date;
}
```

**–§–∏—á–∏ –∫–æ—Ä–∑–∏–Ω—ã:**
- ‚úÖ –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –≥–æ—Å—Ç–µ–π (sessionId)
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –ø–µ—Ä–µ—Å—á–µ—Ç total
- ‚úÖ –ö—É–ø–æ–Ω—ã –∏ —Å–∫–∏–¥–∫–∏
- ‚úÖ –ü–æ–¥–∞—Ä–æ—á–Ω–∞—è —É–ø–∞–∫–æ–≤–∫–∞
- ‚úÖ –ö–∞—Å—Ç–æ–º–Ω—ã–µ –æ–ø—Ü–∏–∏ (—Ü–≤–µ—Ç, —Ä–∞–∑–º–µ—Ä)

---

#### üì¶ 3. SOUVENIR_ORDER (–ó–∞–∫–∞–∑)

```typescript
interface SouvenirOrder {
  id: string;
  orderNumber: string; // —É–Ω–∏–∫–∞–ª—å–Ω—ã–π –Ω–æ–º–µ—Ä
  userId?: string;
  
  // –°—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è
  customerInfo: CustomerInfo;
  items: OrderItem[];
  pricing: OrderPricing;
  shipping: ShippingInfo;
  payment: PaymentInfo;
  
  // –°—Ç–∞—Ç—É—Å
  status: OrderStatus; // 7 —Å—Ç–∞—Ç—É—Å–æ–≤
  trackingNumber?: string;
  notes?: string;
  
  createdAt: Date;
  updatedAt: Date;
}
```

**7 —Å—Ç–∞—Ç—É—Å–æ–≤ –∑–∞–∫–∞–∑–∞:**
1. `pending` - –°–æ–∑–¥–∞–Ω, –æ–∂–∏–¥–∞–µ—Ç –æ–±—Ä–∞–±–æ—Ç–∫–∏
2. `confirmed` - –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω
3. `processing` - –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç—Å—è
4. `shipped` - –û—Ç–ø—Ä–∞–≤–ª–µ–Ω
5. `delivered` - –î–æ—Å—Ç–∞–≤–ª–µ–Ω
6. `cancelled` - –û—Ç–º–µ–Ω–µ–Ω
7. `refunded` - –í–æ–∑–≤—Ä–∞—â–µ–Ω

**CustomerInfo:**
```typescript
interface CustomerInfo {
  firstName: string;
  lastName: string;
  email: string;
  phone: string;
  company?: string;
  address: ShippingAddress;
}
```

**ShippingAddress:**
```typescript
interface ShippingAddress {
  country: string;
  region: string;
  city: string;
  postalCode: string;
  street: string;
  building: string;
  apartment?: string;
  instructions?: string; // –¥–ª—è –∫—É—Ä—å–µ—Ä–∞
}
```

---

#### üí∞ 4. ORDER_PRICING (–¶–µ–Ω–æ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ)

```typescript
interface OrderPricing {
  subtotal: number; // —Å—É–º–º–∞ —Ç–æ–≤–∞—Ä–æ–≤
  discountAmount: number; // —Å–∫–∏–¥–∫–∏
  taxAmount: number; // –Ω–∞–ª–æ–≥–∏
  shippingCost: number; // –¥–æ—Å—Ç–∞–≤–∫–∞
  total: number; // –∏—Ç–æ–≥–æ
  currency: string;
  couponCode?: string;
  couponDiscount?: number;
}
```

**–§–æ—Ä–º—É–ª–∞ —Ä–∞—Å—á–µ—Ç–∞:**
```
total = subtotal - discountAmount + taxAmount + shippingCost - couponDiscount
```

---

#### üöö 5. SHIPPING_INFO (–î–æ—Å—Ç–∞–≤–∫–∞)

```typescript
interface ShippingInfo {
  method: ShippingMethod; // 3 –º–µ—Ç–æ–¥–∞
  cost: number;
  estimatedDays: number;
  trackingNumber?: string;
  shippedAt?: Date;
  deliveredAt?: Date;
  address: ShippingAddress;
}

type ShippingMethod =
  | 'standard' // —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∞—è –¥–æ—Å—Ç–∞–≤–∫–∞
  | 'express'  // —ç–∫—Å–ø—Ä–µ—Å—Å
  | 'pickup';  // —Å–∞–º–æ–≤—ã–≤–æ–∑
```

---

#### üí≥ 6. PAYMENT_INFO (–ü–ª–∞—Ç–µ–∂–∏)

```typescript
interface PaymentInfo {
  method: PaymentMethod;
  status: PaymentStatus;
  transactionId?: string;
  paidAt?: Date;
  amount: number;
  currency: string;
}

type PaymentMethod =
  | 'card'              // –±–∞–Ω–∫–æ–≤—Å–∫–∞—è –∫–∞—Ä—Ç–∞
  | 'bank_transfer'     // –±–∞–Ω–∫–æ–≤—Å–∫–∏–π –ø–µ—Ä–µ–≤–æ–¥
  | 'cash_on_delivery'; // –Ω–∞–ª–æ–∂–µ–Ω–Ω—ã–π –ø–ª–∞—Ç–µ–∂

type PaymentStatus =
  | 'pending'   // –æ–∂–∏–¥–∞–µ—Ç –æ–ø–ª–∞—Ç—ã
  | 'paid'      // –æ–ø–ª–∞—á–µ–Ω
  | 'failed'    // –æ—à–∏–±–∫–∞ –æ–ø–ª–∞—Ç—ã
  | 'refunded'; // –≤–æ–∑–≤—Ä–∞—â–µ–Ω
```

---

#### ‚≠ê 7. PRODUCT_REVIEW (–û—Ç–∑—ã–≤—ã)

```typescript
interface ProductReview {
  id: string;
  souvenirId: string;
  orderId: string;
  userId?: string;
  
  customerName: string;
  customerEmail: string;
  
  rating: number; // 1-5
  title: string;
  comment: string;
  images?: string[]; // —Ñ–æ—Ç–æ –æ—Ç–∑—ã–≤–∞
  
  isVerified: boolean; // –∫—É–ø–ª–µ–Ω –ª–∏ —Ç–æ–≤–∞—Ä
  helpful: number; // –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ "–ø–æ–ª–µ–∑–Ω–æ"
  
  createdAt: Date;
  updatedAt: Date;
}
```

**–§–∏—á–∏ –æ—Ç–∑—ã–≤–æ–≤:**
- ‚úÖ Verified purchases (–ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–Ω—ã–µ –ø–æ–∫—É–ø–∫–∏)
- ‚úÖ –§–æ—Ç–æ –≤ –æ—Ç–∑—ã–≤–∞—Ö
- ‚úÖ Helpful counter (–ø–æ–ª–µ–∑–Ω–æ—Å—Ç—å)
- ‚úÖ –†–µ–π—Ç–∏–Ω–≥ –æ—Ç 1 –¥–æ 5

---

#### üé´ 8. COUPON (–ö—É–ø–æ–Ω—ã)

```typescript
interface Coupon {
  id: string;
  code: string; // —É–Ω–∏–∫–∞–ª—å–Ω—ã–π –∫–æ–¥
  name: string;
  description: string;
  
  // –¢–∏–ø —Å–∫–∏–¥–∫–∏
  discountType: 'percentage' | 'fixed';
  discountValue: number;
  
  // –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è
  minPurchase?: number;
  maxDiscount?: number;
  
  // –°—Ä–æ–∫ –¥–µ–π—Å—Ç–≤–∏—è
  validFrom: Date;
  validTo: Date;
  
  // –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ
  usageLimit?: number;
  usedCount: number;
  
  // –ü—Ä–∏–º–µ–Ω–∏–º–æ—Å—Ç—å
  applicableCategories?: SouvenirCategory[];
  applicableProducts?: string[]; // souvenir IDs
  
  isActive: boolean;
  createdAt: Date;
  updatedAt: Date;
}
```

**–ü—Ä–∏–º–µ—Ä—ã –∫—É–ø–æ–Ω–æ–≤:**
```typescript
// 1. –ü—Ä–æ—Ü–µ–Ω—Ç–Ω–∞—è —Å–∫–∏–¥–∫–∞
{
  code: "KAMCHATKA10",
  discountType: "percentage",
  discountValue: 10, // 10%
  minPurchase: 1000 // –æ—Ç 1000‚ÇΩ
}

// 2. –§–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω–∞—è —Å–∫–∏–¥–∫–∞
{
  code: "WELCOME500",
  discountType: "fixed",
  discountValue: 500, // 500‚ÇΩ
  usageLimit: 1 // –æ–¥–Ω–æ—Ä–∞–∑–æ–≤—ã–π
}

// 3. –ö–∞—Ç–µ–≥–æ—Ä–∏–π–Ω—ã–π –∫—É–ø–æ–Ω
{
  code: "JEWELRY20",
  discountType: "percentage",
  discountValue: 20,
  applicableCategories: ["jewelry"]
}
```

---

#### ‚öôÔ∏è 9. SOUVENIR_SHOP_SETTINGS (–ù–∞—Å—Ç—Ä–æ–π–∫–∏)

```typescript
interface SouvenirShopSettings {
  id: string;
  isEnabled: boolean;
  
  // –í–∞–ª—é—Ç–∞ –∏ –Ω–∞–ª–æ–≥–∏
  currency: string;
  taxRate: number;
  
  // –î–æ—Å—Ç–∞–≤–∫–∞
  freeShippingThreshold?: number;
  defaultShippingCost: number;
  expressShippingCost: number;
  pickupAddress: ShippingAddress;
  
  // –ß–∞—Å—ã —Ä–∞–±–æ—Ç—ã
  businessHours: {
    monday: { open: string; close: string };
    tuesday: { open: string; close: string };
    wednesday: { open: string; close: string };
    thursday: { open: string; close: string };
    friday: { open: string; close: string };
    saturday: { open: string; close: string };
    sunday: { open: string; close: string };
  };
  
  // –ö–æ–Ω—Ç–∞–∫—Ç—ã
  contactInfo: {
    phone: string;
    email: string;
    address: ShippingAddress;
  };
  
  // –°–æ—Ü–∏–∞–ª—å–Ω—ã–µ —Å–µ—Ç–∏
  socialLinks: {
    instagram?: string;
    facebook?: string;
    vk?: string;
  };
  
  updatedAt: Date;
}
```

---

#### üìä 10. SOUVENIR_SHOP_STATS (–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞)

```typescript
interface SouvenirShopStats {
  totalProducts: number;
  activeProducts: number;
  totalOrders: number;
  pendingOrders: number;
  completedOrders: number;
  totalRevenue: number;
  monthlyRevenue: number;
  averageOrderValue: number;
  
  topSellingProducts: {
    souvenirId: string;
    name: string;
    salesCount: number;
    revenue: number;
  }[];
  
  lowStockProducts: {
    souvenirId: string;
    name: string;
    stockQuantity: number;
  }[];
}
```

---

### 2.2 Helper Types (5 —Ç–∏–ø–æ–≤)

#### ProductOption
–ö–∞—Å—Ç–æ–º–Ω—ã–µ –æ–ø—Ü–∏–∏ —Ç–æ–≤–∞—Ä–∞ (—Ü–≤–µ—Ç, —Ä–∞–∑–º–µ—Ä, –º–∞—Ç–µ—Ä–∏–∞–ª, —Å—Ç–∏–ª—å)

#### SouvenirFilters
–§–∏–ª—å—Ç—Ä—ã –¥–ª—è –ø–æ–∏—Å–∫–∞ –∏ —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏

#### SouvenirSearchResult
–†–µ–∑—É–ª—å—Ç–∞—Ç –ø–æ–∏—Å–∫–∞ —Å –ø–∞–≥–∏–Ω–∞—Ü–∏–µ–π

#### SouvenirFormData
–§–æ—Ä–º–∞ —Å–æ–∑–¥–∞–Ω–∏—è/—Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è —Ç–æ–≤–∞—Ä–∞

#### OrderFormData
–§–æ—Ä–º–∞ –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏—è –∑–∞–∫–∞–∑–∞

---

## üóÑÔ∏è 3. DATABASE SCHEMA (6 —Ç–∞–±–ª–∏—Ü)

### 3.1 Table: `souvenirs`

```sql
CREATE TABLE souvenirs (
  id UUID PRIMARY KEY DEFAULT uuid_generate_v4(),
  name VARCHAR(255) NOT NULL,
  description TEXT NOT NULL,
  short_description TEXT,
  category VARCHAR(50) NOT NULL,
  subcategory VARCHAR(100),
  price DECIMAL(10,2) NOT NULL,
  currency VARCHAR(3) DEFAULT 'RUB',
  discount_price DECIMAL(10,2),
  images JSONB DEFAULT '[]',
  video_url TEXT,
  tags JSONB DEFAULT '[]',
  is_active BOOLEAN DEFAULT TRUE,
  is_featured BOOLEAN DEFAULT FALSE,
  stock_quantity INTEGER DEFAULT 0,
  low_stock_threshold INTEGER DEFAULT 5,
  weight DECIMAL(10,2),
  dimensions JSONB,
  materials JSONB DEFAULT '[]',
  origin VARCHAR(255) DEFAULT '–†–æ—Å—Å–∏—è',
  artisan VARCHAR(255),
  rating DECIMAL(3,2) DEFAULT 0.0,
  review_count INTEGER DEFAULT 0,
  sales_count INTEGER DEFAULT 0,
  created_at TIMESTAMPTZ DEFAULT NOW(),
  updated_at TIMESTAMPTZ DEFAULT NOW()
);

-- Indexes
CREATE INDEX idx_souvenirs_category ON souvenirs(category);
CREATE INDEX idx_souvenirs_price ON souvenirs(price);
CREATE INDEX idx_souvenirs_rating ON souvenirs(rating);
CREATE INDEX idx_souvenirs_is_active ON souvenirs(is_active);
```

**–†–∞–∑–º–µ—Ä:** ~30 –ø–æ–ª–µ–π  
**–ò–Ω–¥–µ–∫—Å—ã:** 4 –∏–Ω–¥–µ–∫—Å–∞ (category, price, rating, is_active)

---

### 3.2 Table: `shopping_carts`

```sql
CREATE TABLE shopping_carts (
  id UUID PRIMARY KEY DEFAULT uuid_generate_v4(),
  user_id UUID REFERENCES users(id),
  session_id VARCHAR(255) NOT NULL,
  subtotal DECIMAL(10,2) DEFAULT 0,
  discount_amount DECIMAL(10,2) DEFAULT 0,
  tax_amount DECIMAL(10,2) DEFAULT 0,
  shipping_cost DECIMAL(10,2) DEFAULT 0,
  total DECIMAL(10,2) DEFAULT 0,
  currency VARCHAR(3) DEFAULT 'RUB',
  coupon_code VARCHAR(50),
  coupon_discount DECIMAL(10,2) DEFAULT 0,
  created_at TIMESTAMPTZ DEFAULT NOW(),
  updated_at TIMESTAMPTZ DEFAULT NOW(),
  UNIQUE(session_id)
);

-- Indexes
CREATE INDEX idx_carts_user_id ON shopping_carts(user_id);
CREATE INDEX idx_carts_session_id ON shopping_carts(session_id);
```

**–°–≤—è–∑–∏:** `users.id` (M:1)  
**–ò–Ω–¥–µ–∫—Å—ã:** 2 –∏–Ω–¥–µ–∫—Å–∞ + UNIQUE constraint

---

### 3.3 Table: `cart_items`

```sql
CREATE TABLE cart_items (
  id UUID PRIMARY KEY DEFAULT uuid_generate_v4(),
  cart_id UUID REFERENCES shopping_carts(id) ON DELETE CASCADE,
  souvenir_id UUID REFERENCES souvenirs(id),
  quantity INTEGER NOT NULL DEFAULT 1,
  selected_options JSONB DEFAULT '[]',
  gift_message TEXT,
  gift_wrap BOOLEAN DEFAULT FALSE,
  unit_price DECIMAL(10,2) NOT NULL,
  total_price DECIMAL(10,2) NOT NULL,
  added_at TIMESTAMPTZ DEFAULT NOW(),
  UNIQUE(cart_id, souvenir_id)
);

CREATE INDEX idx_cart_items_cart_id ON cart_items(cart_id);
```

**–°–≤—è–∑–∏:** 
- `shopping_carts.id` (M:1, CASCADE)
- `souvenirs.id` (M:1)

**UNIQUE:** (cart_id, souvenir_id) - —Ç–æ–≤–∞—Ä –º–æ–∂–µ—Ç –±—ã—Ç—å –≤ –∫–æ—Ä–∑–∏–Ω–µ —Ç–æ–ª—å–∫–æ –æ–¥–∏–Ω —Ä–∞–∑

---

### 3.4 Table: `souvenir_orders`

```sql
CREATE TABLE souvenir_orders (
  id UUID PRIMARY KEY DEFAULT uuid_generate_v4(),
  order_number VARCHAR(50) UNIQUE NOT NULL,
  user_id UUID REFERENCES users(id),
  customer_info JSONB NOT NULL,
  items JSONB NOT NULL,
  pricing JSONB NOT NULL,
  shipping JSONB NOT NULL,
  payment JSONB NOT NULL,
  status VARCHAR(50) DEFAULT 'pending',
  tracking_number VARCHAR(100),
  notes TEXT,
  created_at TIMESTAMPTZ DEFAULT NOW(),
  updated_at TIMESTAMPTZ DEFAULT NOW()
);

-- Indexes
CREATE INDEX idx_souvenir_orders_user_id ON souvenir_orders(user_id);
CREATE INDEX idx_souvenir_orders_status ON souvenir_orders(status);
CREATE INDEX idx_souvenir_orders_order_number ON souvenir_orders(order_number);
```

**–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç—å:** –ò—Å–ø–æ–ª—å–∑—É–µ—Ç JSONB –¥–ª—è –≥–∏–±–∫–æ—Å—Ç–∏ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã  
**–ò–Ω–¥–µ–∫—Å—ã:** 3 –∏–Ω–¥–µ–∫—Å–∞ + UNIQUE –Ω–∞ order_number

---

### 3.5 Table: `product_reviews`

```sql
CREATE TABLE product_reviews (
  id UUID PRIMARY KEY DEFAULT uuid_generate_v4(),
  souvenir_id UUID REFERENCES souvenirs(id) ON DELETE CASCADE,
  order_id UUID REFERENCES souvenir_orders(id),
  user_id UUID REFERENCES users(id),
  customer_name VARCHAR(255) NOT NULL,
  customer_email VARCHAR(255) NOT NULL,
  rating INTEGER NOT NULL CHECK (rating >= 1 AND rating <= 5),
  title VARCHAR(255),
  comment TEXT NOT NULL,
  images JSONB DEFAULT '[]',
  is_verified BOOLEAN DEFAULT FALSE,
  helpful INTEGER DEFAULT 0,
  created_at TIMESTAMPTZ DEFAULT NOW(),
  updated_at TIMESTAMPTZ DEFAULT NOW()
);

-- Indexes
CREATE INDEX idx_product_reviews_souvenir_id ON product_reviews(souvenir_id);
CREATE INDEX idx_product_reviews_rating ON product_reviews(rating);
```

**CHECK constraint:** rating BETWEEN 1 AND 5  
**–°–≤—è–∑–∏:** 3 foreign keys (souvenir, order, user)

---

### 3.6 Table: `souvenir_coupons`

```sql
CREATE TABLE souvenir_coupons (
  id UUID PRIMARY KEY DEFAULT uuid_generate_v4(),
  code VARCHAR(50) UNIQUE NOT NULL,
  name VARCHAR(255) NOT NULL,
  description TEXT,
  discount_type VARCHAR(20) NOT NULL CHECK (discount_type IN ('percentage', 'fixed')),
  discount_value DECIMAL(10,2) NOT NULL,
  min_purchase DECIMAL(10,2),
  max_discount DECIMAL(10,2),
  valid_from TIMESTAMPTZ NOT NULL,
  valid_to TIMESTAMPTZ NOT NULL,
  usage_limit INTEGER,
  used_count INTEGER DEFAULT 0,
  applicable_categories JSONB DEFAULT '[]',
  applicable_products JSONB DEFAULT '[]',
  is_active BOOLEAN DEFAULT TRUE,
  created_at TIMESTAMPTZ DEFAULT NOW(),
  updated_at TIMESTAMPTZ DEFAULT NOW()
);

-- Indexes
CREATE INDEX idx_souvenir_coupons_code ON souvenir_coupons(code);
CREATE INDEX idx_souvenir_coupons_is_active ON souvenir_coupons(is_active);
```

**CHECK constraint:** discount_type IN ('percentage', 'fixed')  
**UNIQUE:** code (—É–Ω–∏–∫–∞–ª—å–Ω—ã–µ –ø—Ä–æ–º–æ–∫–æ–¥—ã)

---

## üîó 4. –°–í–Ø–ó–ò –ú–ï–ñ–î–£ –¢–ê–ë–õ–ò–¶–ê–ú–ò

```
users
‚îú‚îÄ‚Üí shopping_carts (1:M) via user_id
‚îú‚îÄ‚Üí souvenir_orders (1:M) via user_id
‚îî‚îÄ‚Üí product_reviews (1:M) via user_id

souvenirs
‚îú‚îÄ‚Üí cart_items (1:M) via souvenir_id
‚îî‚îÄ‚Üí product_reviews (1:M) via souvenir_id ON DELETE CASCADE

shopping_carts
‚îî‚îÄ‚Üí cart_items (1:M) via cart_id ON DELETE CASCADE

souvenir_orders
‚îî‚îÄ‚Üí product_reviews (1:M) via order_id
```

**–ö–ª—é—á–µ–≤—ã–µ –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:**
- ‚úÖ Cascade delete –¥–ª—è cart_items –∏ product_reviews
- ‚úÖ Optional user_id (–ø–æ–¥–¥–µ—Ä–∂–∫–∞ –≥–æ—Å—Ç–µ–π)
- ‚úÖ JSONB –¥–ª—è –≥–∏–±–∫–∏—Ö —Å—Ç—Ä—É–∫—Ç—É—Ä

---

## üì° 5. API ENDPOINTS

### 5.1 GET /api/souvenirs

**–û–ø–∏—Å–∞–Ω–∏–µ:** –ü–æ–ª—É—á–∏—Ç—å —Å–ø–∏—Å–æ–∫ —Å—É–≤–µ–Ω–∏—Ä–æ–≤ —Å —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–µ–π –∏ –ø–∞–≥–∏–Ω–∞—Ü–∏–µ–π

**Query Parameters:**
```typescript
{
  category?: string;        // —Ñ–∏–ª—å—Ç—Ä –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏
  featured?: boolean;       // —Ç–æ–ª—å–∫–æ featured
  limit?: number;           // –ª–∏–º–∏—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ (default: 20)
  offset?: number;          // —Å–º–µ—â–µ–Ω–∏–µ (default: 0)
}
```

**Response:**
```typescript
{
  success: true,
  data: Souvenir[],
  pagination: {
    total: number,
    limit: number,
    offset: number,
    hasMore: boolean
  }
}
```

**–†–µ–∞–ª–∏–∑–∞—Ü–∏—è:** ‚úÖ MOCK DATA (3 —Ç–æ–≤–∞—Ä–∞)

**Mock —Ç–æ–≤–∞—Ä—ã:**
1. –ú–∞–≥–Ω–∏—Ç "–í—É–ª–∫–∞–Ω –ê–≤–∞—á–∏–Ω—Å–∫–∏–π" - 250‚ÇΩ
2. –ö—Ä—É–∂–∫–∞ "–ú–µ–¥–≤–µ–¥—å –ö–∞–º—á–∞—Ç–∫–∏" - 800‚ÇΩ (—Å–∫–∏–¥–∫–∞ 720‚ÇΩ)
3. –§—É—Ç–±–æ–ª–∫–∞ "–Ø –ª—é–±–ª—é –ö–∞–º—á–∞—Ç–∫—É" - 1500‚ÇΩ

---

### 5.2 POST /api/souvenirs

**–û–ø–∏—Å–∞–Ω–∏–µ:** –°–æ–∑–¥–∞—Ç—å –Ω–æ–≤—ã–π —Å—É–≤–µ–Ω–∏—Ä (–¥–ª—è –∞–¥–º–∏–Ω–æ–≤)

**Request Body:**
```typescript
{
  name: string;
  description: string;
  category: SouvenirCategory;
  price: number;
  // ... –æ—Å—Ç–∞–ª—å–Ω—ã–µ –ø–æ–ª—è Souvenir
}
```

**Response:**
```typescript
{
  success: true,
  data: Souvenir,
  message: "–°—É–≤–µ–Ω–∏—Ä —É—Å–ø–µ—à–Ω–æ —Å–æ–∑–¥–∞–Ω"
}
```

**TODO:** –î–æ–±–∞–≤–∏—Ç—å –ø—Ä–æ–≤–µ—Ä–∫—É –ø—Ä–∞–≤ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞

---

### 5.3 POST /api/souvenirs/orders

**–û–ø–∏—Å–∞–Ω–∏–µ:** –°–æ–∑–¥–∞—Ç—å –Ω–æ–≤—ã–π –∑–∞–∫–∞–∑

**Request Body:**
```typescript
{
  customer: {
    name: string;
    email: string;
    phone: string;
  },
  items: CartItem[],
  delivery: {
    method: ShippingMethod;
    address?: string;
  },
  comments?: string,
  totalPrice: number,
  totalItems: number
}
```

**Response:**
```typescript
{
  success: true,
  data: {
    orderId: string;
    orderNumber: string;
  }
}
```

**–°—Ç–∞—Ç—É—Å:** ‚ö†Ô∏è Endpoint –Ω–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω (–≤—ã–∑—ã–≤–∞–µ—Ç—Å—è –≤ SouvenirCheckout.tsx)

---

## ‚öõÔ∏è 6. REACT –ö–û–ú–ü–û–ù–ï–ù–¢–´

### 6.1 SouvenirCard.tsx (53 —Å—Ç—Ä–æ–∫–∏)

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ö–∞—Ä—Ç–æ—á–∫–∞ —Ç–æ–≤–∞—Ä–∞ –≤ –∫–∞—Ç–∞–ª–æ–≥–µ

**Props:**
```typescript
{
  souvenir: Souvenir;
  onAddToCart: (id: string) => void;
}
```

**–§–∏—á–∏:**
- ‚úÖ –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è (–∏–ª–∏ emoji üéÅ)
- ‚úÖ Badge "–ù–µ—Ç –≤ –Ω–∞–ª–∏—á–∏–∏"
- ‚úÖ –ö–∞—Ç–µ–≥–æ—Ä–∏—è —Ç–æ–≤–∞—Ä–∞
- ‚úÖ –†–µ–π—Ç–∏–Ω–≥ —Å–æ –∑–≤–µ–∑–¥–æ—á–∫–æ–π
- ‚úÖ –¶–µ–Ω–∞ –≤ —Ñ–æ—Ä–º–∞—Ç–µ `1 000 ‚ÇΩ`
- ‚úÖ –ö–Ω–æ–ø–∫–∞ "–í –∫–æ—Ä–∑–∏–Ω—É" (disabled –µ—Å–ª–∏ –Ω–µ—Ç –≤ –Ω–∞–ª–∏—á–∏–∏)
- ‚úÖ Hover —ç—Ñ—Ñ–µ–∫—Ç (scale 1.05)

**Design:**
- Black & Gold theme
- Premium glassmorphism
- Responsive layout

---

### 6.2 ShoppingCart.tsx (119 —Å—Ç—Ä–æ–∫)

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ö–æ—Ä–∑–∏–Ω–∞ –ø–æ–∫—É–ø–æ–∫

**Props:**
```typescript
{
  items: CartItem[];
  onUpdateQuantity: (itemId: string, quantity: number) => void;
  onRemove: (itemId: string) => void;
  onCheckout: () => void;
}
```

**–§–∏—á–∏:**
- ‚úÖ Empty state (–ø—É—Å—Ç–∞—è –∫–æ—Ä–∑–∏–Ω–∞)
- ‚úÖ –°–ø–∏—Å–æ–∫ —Ç–æ–≤–∞—Ä–æ–≤ —Å –º–∏–Ω–∏–∞—Ç—é—Ä–∞–º–∏
- ‚úÖ Quantity picker (- / number / +)
- ‚úÖ –ö–Ω–æ–ø–∫–∞ —É–¥–∞–ª–µ–Ω–∏—è (‚úï)
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –ø–æ–¥—Å—á–µ—Ç –∏—Ç–æ–≥–æ
- ‚úÖ –°–∫–ª–æ–Ω–µ–Ω–∏–µ "—Ç–æ–≤–∞—Ä/—Ç–æ–≤–∞—Ä–∞/—Ç–æ–≤–∞—Ä–æ–≤"
- ‚úÖ –ó–æ–ª–æ—Ç–æ–π –≥—Ä–∞–¥–∏–µ–Ω—Ç –¥–ª—è total

**–õ–æ–≥–∏–∫–∞:**
```typescript
const totalPrice = items.reduce((sum, item) => 
  sum + (item.price * item.quantity), 0
);
const totalItems = items.reduce((sum, item) => 
  sum + item.quantity, 0
);
```

---

### 6.3 SouvenirCheckout.tsx (296 —Å—Ç—Ä–æ–∫)

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –û—Ñ–æ—Ä–º–ª–µ–Ω–∏–µ –∑–∞–∫–∞–∑–∞

**Props:**
```typescript
{
  items: CartItem[];
  onBack: () => void;
  onOrderComplete: () => void;
}
```

**–§–∏—á–∏:**
- ‚úÖ 2-–∫–æ–ª–æ–Ω–æ—á–Ω—ã–π layout (–∑–∞–∫–∞–∑ + —Ñ–æ—Ä–º–∞)
- ‚úÖ Order summary —Å –º–∏–Ω–∏–∞—Ç—é—Ä–∞–º–∏
- ‚úÖ –í–∞–ª–∏–¥–∞—Ü–∏—è —Ñ–æ—Ä–º—ã (–∏–º—è, email, —Ç–µ–ª–µ—Ñ–æ–Ω)
- ‚úÖ Radio –≤—ã–±–æ—Ä –¥–æ—Å—Ç–∞–≤–∫–∏ (pickup / delivery)
- ‚úÖ –£—Å–ª–æ–≤–Ω—ã–π —Ä–µ–Ω–¥–µ—Ä –∞–¥—Ä–µ—Å–∞ (—Ç–æ–ª—å–∫–æ –¥–ª—è delivery)
- ‚úÖ Textarea –¥–ª—è –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤
- ‚úÖ Loading state –ø—Ä–∏ –æ—Ç–ø—Ä–∞–≤–∫–µ
- ‚úÖ Error handling —Å –∫—Ä–∞—Å–Ω—ã–º–∏ –ø–æ–¥—Å–≤–µ—Ç–∫–∞–º–∏
- ‚úÖ POST –∑–∞–ø—Ä–æ—Å –≤ `/api/souvenirs/orders`

**–§–æ—Ä–º–∞:**
```typescript
interface OrderForm {
  name: string;
  email: string;
  phone: string;
  deliveryMethod: 'pickup' | 'delivery';
  address?: string;
  comments?: string;
}
```

**–í–∞–ª–∏–¥–∞—Ü–∏—è:**
- –ò–º—è: –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ
- Email: –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ
- –¢–µ–ª–µ—Ñ–æ–Ω: –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ
- –ê–¥—Ä–µ—Å: –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ —Ç–æ–ª—å–∫–æ –¥–ª—è delivery

---

### 6.4 SouvenirFilters.tsx (???)

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –§–∏–ª—å—Ç—Ä—ã –∏ —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ –∫–∞—Ç–∞–ª–æ–≥–∞

**Props (–ø—Ä–µ–¥–ø–æ–ª–∞–≥–∞–µ–º—ã–µ):**
```typescript
{
  selectedCategory: string;
  onCategoryChange: (cat: string) => void;
  categories: string[];
  priceRange: { min: number; max: number };
  onPriceRangeChange: (range) => void;
  showInStockOnly: boolean;
  onInStockToggle: (bool) => void;
  sortBy: 'name' | 'price-low' | 'price-high' | 'rating';
  onSortChange: (sort) => void;
}
```

**–§–∏—á–∏:**
- ‚úÖ Dropdown –∫–∞—Ç–µ–≥–æ—Ä–∏–π
- ‚úÖ Range slider –¥–ª—è —Ü–µ–Ω—ã
- ‚úÖ Checkbox "–¢–æ–ª—å–∫–æ –≤ –Ω–∞–ª–∏—á–∏–∏"
- ‚úÖ Dropdown —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏

**–°—Ç–∞—Ç—É—Å:** ‚ö†Ô∏è –ö–æ–º–ø–æ–Ω–µ–Ω—Ç —Å—É—â–µ—Å—Ç–≤—É–µ—Ç, –Ω–æ –Ω–µ –ø—Ä–æ—á–∏—Ç–∞–Ω

---

## üì± 7. PAGE COMPONENT (app/hub/souvenirs/page.tsx)

### 7.1 –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

**–°—Ç—Ä—É–∫—Ç—É—Ä–∞:** 268 —Å—Ç—Ä–æ–∫

**State management:**
```typescript
const [souvenirs, setSouvenirs] = useState<Souvenir[]>([]);
const [cart, setCart] = useState<CartItem[]>([]);
const [loading, setLoading] = useState(true);
const [view, setView] = useState<'catalog' | 'cart' | 'checkout'>('catalog');

// Filters
const [selectedCategory, setSelectedCategory] = useState<string>('all');
const [priceRange, setPriceRange] = useState({ min: 0, max: 10000 });
const [showInStockOnly, setShowInStockOnly] = useState(false);
const [sortBy, setSortBy] = useState<'name' | 'price-low' | 'price-high' | 'rating'>('name');
```

---

### 7.2 –ö–ª—é—á–µ–≤—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏

#### fetchSouvenirs()
```typescript
const fetchSouvenirs = async () => {
  const response = await fetch('/api/souvenirs?limit=50');
  const result = await response.json();
  setSouvenirs(result.data);
};
```

#### handleAddToCart()
```typescript
const handleAddToCart = (souvenirId: string) => {
  const souvenir = souvenirs.find(s => s.id === souvenirId);
  const existingItem = cart.find(item => item.souvenirId === souvenirId);
  
  if (existingItem) {
    // –£–≤–µ–ª–∏—á–∏–≤–∞–µ–º quantity
    setCart(cart.map(item => 
      item.souvenirId === souvenirId 
        ? { ...item, quantity: item.quantity + 1 }
        : item
    ));
  } else {
    // –î–æ–±–∞–≤–ª—è–µ–º –Ω–æ–≤—ã–π item
    setCart([...cart, {
      id: `cart-${Date.now()}`,
      souvenirId,
      name: souvenir.name,
      price: souvenir.price,
      quantity: 1,
      imageUrl: souvenir.imageUrl
    }]);
  }
  
  setView('cart'); // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–µ—Ä–µ—Ö–æ–¥–∏–º –≤ –∫–æ—Ä–∑–∏–Ω—É
};
```

#### getFilteredAndSortedSouvenirs()
```typescript
const getFilteredAndSortedSouvenirs = () => {
  let filtered = souvenirs.filter(souvenir => {
    // –§–∏–ª—å—Ç—Ä –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏
    if (selectedCategory !== 'all' && souvenir.category !== selectedCategory) {
      return false;
    }
    
    // –§–∏–ª—å—Ç—Ä –ø–æ —Ü–µ–Ω–µ
    if (souvenir.price < priceRange.min || souvenir.price > priceRange.max) {
      return false;
    }
    
    // –§–∏–ª—å—Ç—Ä –ø–æ –Ω–∞–ª–∏—á–∏—é
    if (showInStockOnly && !souvenir.inStock) {
      return false;
    }
    
    return true;
  });
  
  // –°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞
  filtered.sort((a, b) => {
    switch (sortBy) {
      case 'price-low':
        return a.price - b.price;
      case 'price-high':
        return b.price - a.price;
      case 'rating':
        return (b.rating || 0) - (a.rating || 0);
      case 'name':
      default:
        return a.name.localeCompare(b.name);
    }
  });
  
  return filtered;
};
```

---

### 7.3 View Management (3 –≤–∏–¥–∞)

#### View 1: Catalog
```typescript
{view === 'catalog' && (
  <>
    <SouvenirFilters {...filterProps} />
    <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
      {filteredSouvenirs.map((souvenir) => (
        <SouvenirCard
          key={souvenir.id}
          souvenir={souvenir}
          onAddToCart={handleAddToCart}
        />
      ))}
    </div>
  </>
)}
```

#### View 2: Cart
```typescript
{view === 'cart' && (
  <ShoppingCart
    items={cart}
    onUpdateQuantity={handleUpdateQuantity}
    onRemove={handleRemove}
    onCheckout={handleCheckout}
  />
)}
```

#### View 3: Checkout
```typescript
{view === 'checkout' && (
  <SouvenirCheckout
    items={cart}
    onBack={handleBackToCart}
    onOrderComplete={handleOrderComplete}
  />
)}
```

---

### 7.4 Header Design

```typescript
<div className="bg-white/5 border-b border-white/10 p-6">
  <div className="flex justify-between items-center">
    {/* Title */}
    <div>
      <h1 className="text-3xl font-black text-premium-gold">
        –°—É–≤–µ–Ω–∏—Ä—ã –ö–∞–º—á–∞—Ç–∫–∏
      </h1>
      <p className="text-white/70">–£–Ω–∏–∫–∞–ª—å–Ω—ã–µ –ø–æ–¥–∞—Ä–∫–∏ –∏ —Å—É–≤–µ–Ω–∏—Ä—ã</p>
    </div>
    
    {/* Actions */}
    <div className="flex items-center gap-4">
      {view !== 'catalog' && (
        <button onClick={handleBackToCatalog}>‚Üê –ö–∞—Ç–∞–ª–æ–≥</button>
      )}
      
      {/* Cart Button —Å Badge */}
      <button className="relative">
        üõí –ö–æ—Ä–∑–∏–Ω–∞
        {cart.length > 0 && (
          <span className="absolute -top-2 -right-2 w-6 h-6 bg-red-500 rounded-full">
            {cart.reduce((sum, item) => sum + item.quantity, 0)}
          </span>
        )}
      </button>
    </div>
  </div>
</div>
```

---

## üîê 8. –ë–ï–ó–û–ü–ê–°–ù–û–°–¢–¨ –ò –î–û–°–¢–£–ü

### 8.1 Protected Route

```typescript
<Protected roles={['tourist', 'admin']}>
  <main>...</main>
</Protected>
```

**–î–æ—Å—Ç—É–ø:**
- ‚úÖ Tourist (–ø–æ–∫—É–ø–∞—Ç–µ–ª–∏)
- ‚úÖ Admin (–º–æ–¥–µ—Ä–∞—Ç–æ—Ä—ã)
- ‚ùå Operator, Guide, Transfer, Agent (–Ω–µ—Ç –¥–æ—Å—Ç—É–ø–∞)

---

### 8.2 –û—Ç—Å—É—Ç—Å—Ç–≤—É—é—â–∞—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

‚ö†Ô∏è **–ü—Ä–æ–±–ª–µ–º—ã:**
1. –ù–µ—Ç –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ –≤ API endpoints
2. POST /api/souvenirs –Ω–µ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç —Ä–æ–ª—å –∞–¥–º–∏–Ω–∞
3. –ù–µ—Ç CSRF –∑–∞—â–∏—Ç—ã –¥–ª—è –∑–∞–∫–∞–∑–æ–≤
4. –ù–µ—Ç rate limiting
5. –û—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç –≤–∞–ª–∏–¥–∞—Ü–∏—è –Ω–∞ –±—ç–∫–µ–Ω–¥–µ

---

## üìä 9. –ë–ò–ó–ù–ï–°-–õ–û–ì–ò–ö–ê

### 9.1 Pricing Flow

```
–¢–æ–≤–∞—Ä ‚Üí –ö–æ—Ä–∑–∏–Ω–∞ ‚Üí –ö—É–ø–æ–Ω ‚Üí –ù–∞–ª–æ–≥ ‚Üí –î–æ—Å—Ç–∞–≤–∫–∞ ‚Üí –ò—Ç–æ–≥–æ
```

**–§–æ—Ä–º—É–ª–∞:**
```typescript
subtotal = items.reduce((sum, item) => sum + (item.price * item.quantity), 0);
discountAmount = subtotal * discountPercent / 100;
taxAmount = (subtotal - discountAmount) * taxRate;
shippingCost = calculateShipping(items, method);
total = subtotal - discountAmount + taxAmount + shippingCost;
```

---

### 9.2 Order Lifecycle

```
1. –°–æ–∑–¥–∞–Ω–∏–µ –∑–∞–∫–∞–∑–∞ (status: pending)
   ‚Üì
2. –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –æ–ø–µ—Ä–∞—Ç–æ—Ä–æ–º (status: confirmed)
   ‚Üì
3. –û–±—Ä–∞–±–æ—Ç–∫–∞ (status: processing)
   ‚Üì
4. –û—Ç–ø—Ä–∞–≤–∫–∞ (status: shipped, tracking_number)
   ‚Üì
5. –î–æ—Å—Ç–∞–≤–∫–∞ (status: delivered)
   
   –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–µ –ø—É—Ç–∏:
   ‚Üì
6a. –û—Ç–º–µ–Ω–∞ (status: cancelled)
6b. –í–æ–∑–≤—Ä–∞—Ç (status: refunded)
```

---

### 9.3 Stock Management

```typescript
// –ü—Ä–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏–∏ –≤ –∫–æ—Ä–∑–∏–Ω—É
cart_item.quantity = 1;

// –ü—Ä–∏ –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏–∏ –∑–∞–∫–∞–∑–∞
souvenir.stock_quantity -= order_item.quantity;

// –ü—Ä–æ–≤–µ—Ä–∫–∞ low stock
if (souvenir.stock_quantity <= souvenir.low_stock_threshold) {
  notifyAdmin('Low stock alert', souvenir);
}

// –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –¥–µ–∞–∫—Ç–∏–≤–∞—Ü–∏—è
if (souvenir.stock_quantity === 0) {
  souvenir.is_active = false;
}
```

---

## üé® 10. UI/UX –î–ò–ó–ê–ô–ù

### 10.1 –¶–≤–µ—Ç–æ–≤–∞—è —Å—Ö–µ–º–∞

```css
/* Primary Colors */
--premium-black: #0a0a0a;
--premium-gold: #d4af37;
--white: #ffffff;

/* Semantic Colors */
--success: #10B981; /* Green */
--error: #EF4444;   /* Red */
--warning: #F59E0B; /* Orange */

/* Glassmorphism */
background: rgba(255, 255, 255, 0.05);
border: 1px solid rgba(255, 255, 255, 0.1);
backdrop-filter: blur(10px);
```

---

### 10.2 Typography

```css
/* Headings */
h1: text-3xl font-black text-premium-gold
h2: text-2xl font-bold
h3: text-xl font-bold

/* Body */
p: text-white/70
small: text-white/50 text-sm

/* Price */
.price: text-2xl font-black text-premium-gold
```

---

### 10.3 Components Style

**Cards:**
```css
.card {
  background: rgba(255, 255, 255, 0.05);
  border: 1px solid rgba(255, 255, 255, 0.1);
  border-radius: 16px;
  transition: all 0.3s ease;
}
.card:hover {
  background: rgba(255, 255, 255, 0.1);
  transform: scale(1.05);
}
```

**Buttons:**
```css
/* Primary (Gold) */
.btn-primary {
  background: #d4af37;
  color: #0a0a0a;
  font-weight: 600;
  border-radius: 12px;
  transition: all 0.2s;
}
.btn-primary:hover {
  background: rgba(212, 175, 55, 0.8);
}

/* Secondary */
.btn-secondary {
  background: rgba(255, 255, 255, 0.1);
  color: white;
  border: 1px solid rgba(255, 255, 255, 0.2);
}
```

---

## ‚ö° 11. –ü–†–û–ò–ó–í–û–î–ò–¢–ï–õ–¨–ù–û–°–¢–¨

### 11.1 –¢–µ–∫—É—â–∞—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

**–û—Ü–µ–Ω–∫–∞:**
- ‚úÖ Lazy loading –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π (–Ω–µ—Ç)
- ‚úÖ –ú–µ–º–æ–∏–∑–∞—Ü–∏—è (–Ω–µ—Ç)
- ‚úÖ –í–∏—Ä—Ç—É–∞–ª–∏–∑–∞—Ü–∏—è —Å–ø–∏—Å–∫–æ–≤ (–Ω–µ—Ç)
- ‚ö†Ô∏è Mock data (–±—ã—Å—Ç—Ä–æ, –Ω–æ –Ω–µ –ø—Ä–æ–¥–∞–∫—à–Ω)

**Lighthouse Score (–ø—Ä–µ–¥–ø–æ–ª–∞–≥–∞–µ–º—ã–π):**
- Performance: 70-80
- Accessibility: 85-90
- Best Practices: 75-85
- SEO: 80-90

---

### 11.2 –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏

**1. Images:**
```typescript
// –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Next.js Image
import Image from 'next/image';

<Image 
  src={souvenir.imageUrl}
  alt={souvenir.name}
  width={300}
  height={200}
  loading="lazy"
  placeholder="blur"
/>
```

**2. Memoization:**
```typescript
// –ú–µ–º–æ–∏–∑–∏—Ä–æ–≤–∞—Ç—å –¥–æ—Ä–æ–≥–∏–µ –≤—ã—á–∏—Å–ª–µ–Ω–∏—è
const filteredSouvenirs = useMemo(() => {
  return getFilteredAndSortedSouvenirs();
}, [souvenirs, selectedCategory, priceRange, showInStockOnly, sortBy]);

// –ú–µ–º–æ–∏–∑–∏—Ä–æ–≤–∞—Ç—å callbacks
const handleAddToCart = useCallback((id: string) => {
  // ...
}, [souvenirs, cart]);
```

**3. Virtual Scrolling:**
```typescript
// –î–ª—è –∫–∞—Ç–∞–ª–æ–≥–∞ —Å –±–æ–ª—å—à–∏–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ–º —Ç–æ–≤–∞—Ä–æ–≤
import { FixedSizeGrid } from 'react-window';

<FixedSizeGrid
  columnCount={3}
  columnWidth={350}
  height={800}
  rowCount={Math.ceil(filteredSouvenirs.length / 3)}
  rowHeight={450}
  width={1100}
>
  {({ columnIndex, rowIndex, style }) => (
    <div style={style}>
      <SouvenirCard souvenir={...} />
    </div>
  )}
</FixedSizeGrid>
```

---

## üöß 12. –ü–†–û–ë–õ–ï–ú–´ –ò –ù–ï–î–û–°–¢–ê–¢–ö–ò

### 12.1 –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–æ–±–ª–µ–º—ã

1. **‚ùå Mock Data**
   - API –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –∑–∞—Ö–∞—Ä–¥–∫–æ–∂–µ–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
   - –ù–µ—Ç –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ —Å PostgreSQL
   - –ù–µ—Ç persistence –∫–æ—Ä–∑–∏–Ω—ã

2. **‚ùå –ù–µ—Ä–∞–±–æ—Ç–∞—é—â–∏–π API**
   - `POST /api/souvenirs/orders` –Ω–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω
   - –ü—Ä–∏ –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏–∏ –∑–∞–∫–∞–∑–∞ –±—É–¥–µ—Ç 404 –æ—à–∏–±–∫–∞

3. **‚ùå –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏**
   - –ù–µ—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø—Ä–∞–≤ –≤ API
   - –õ—é–±–æ–π –º–æ–∂–µ—Ç —Å–æ–∑–¥–∞–≤–∞—Ç—å —Å—É–≤–µ–Ω–∏—Ä—ã

4. **‚ùå –ù–µ—Ç —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Å–æ—Å—Ç–æ—è–Ω–∏–µ–º**
   - –ö–æ—Ä–∑–∏–Ω–∞ —Å–±—Ä–∞—Å—ã–≤–∞–µ—Ç—Å—è –ø—Ä–∏ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–µ
   - –ù–µ—Ç localStorage/sessionStorage

---

### 12.2 –í–∞–∂–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã

5. **‚ö†Ô∏è –û—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç admin panel**
   - –ù–µ—Ç UI –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è —Ç–æ–≤–∞—Ä–æ–≤
   - –ù–µ—Ç UI –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∑–∞–∫–∞–∑–∞–º–∏
   - –ù–µ—Ç —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏

6. **‚ö†Ô∏è –ù–µ—Ç payment –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏**
   - –ó–∞–∫–∞–∑ —Å–æ–∑–¥–∞–µ—Ç—Å—è, –Ω–æ –æ–ø–ª–∞—Ç–∞ –Ω–µ –ø—Ä–∏–Ω–∏–º–∞–µ—Ç—Å—è
   - –ù—É–∂–Ω–∞ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å CloudPayments

7. **‚ö†Ô∏è –û—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç email-–Ω–æ—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è**
   - –ö–ª–∏–µ–Ω—Ç –Ω–µ –ø–æ–ª—É—á–∞–µ—Ç –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –∑–∞–∫–∞–∑–∞
   - –û–ø–µ—Ä–∞—Ç–æ—Ä –Ω–µ –ø–æ–ª—É—á–∞–µ—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ –Ω–æ–≤–æ–º –∑–∞–∫–∞–∑–µ

8. **‚ö†Ô∏è –ù–µ—Ç –ª–æ–≥–∏—Å—Ç–∏–∫–∏**
   - –ù–µ—Ç –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ —Å –∫—É—Ä—å–µ—Ä—Å–∫–∏–º–∏ —Å–ª—É–∂–±–∞–º–∏
   - –ù–µ—Ç real-time —Ç—Ä–µ–∫–∏–Ω–≥–∞ –¥–æ—Å—Ç–∞–≤–∫–∏

---

### 12.3 –ú–µ–ª–∫–∏–µ –ø—Ä–æ–±–ª–µ–º—ã

9. ‚ö†Ô∏è –û—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è —Ç–æ–≤–∞—Ä–æ–≤ (placeholder üéÅ)
10. ‚ö†Ô∏è –ù–µ—Ç –ø–æ–∏—Å–∫–∞ –ø–æ –∫–∞—Ç–∞–ª–æ–≥—É
11. ‚ö†Ô∏è –ù–µ—Ç —Ñ—É–Ω–∫—Ü–∏–∏ "–ò–∑–±—Ä–∞–Ω–Ω–æ–µ"
12. ‚ö†Ô∏è –ù–µ—Ç —Å—Ä–∞–≤–Ω–µ–Ω–∏—è —Ç–æ–≤–∞—Ä–æ–≤
13. ‚ö†Ô∏è –ù–µ—Ç —Å–≤—è–∑–∞–Ω–Ω—ã—Ö —Ç–æ–≤–∞—Ä–æ–≤
14. ‚ö†Ô∏è –ù–µ—Ç –∏—Å—Ç–æ—Ä–∏–∏ –ø—Ä–æ—Å–º–æ—Ç—Ä–æ–≤
15. ‚ö†Ô∏è –ù–µ—Ç mobile app
16. ‚ö†Ô∏è –ù–µ—Ç multi-language support

---

## ‚úÖ 13. –ì–û–¢–û–í–ù–û–°–¢–¨ –ú–û–î–£–õ–Ø

### 13.1 Checklist

**Types & Schema: 95%**
- ‚úÖ TypeScript types (15 –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–æ–≤)
- ‚úÖ SQL schema (6 —Ç–∞–±–ª–∏—Ü)
- ‚ö†Ô∏è –ù–µ—Ç –º–∏–≥—Ä–∞—Ü–∏–π

**API: 40%**
- ‚úÖ GET /api/souvenirs (mock)
- ‚úÖ POST /api/souvenirs (mock)
- ‚ùå POST /api/souvenirs/orders (–Ω–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω)
- ‚ùå –ù–µ—Ç endpoints –¥–ª—è –∫—É–ø–æ–Ω–æ–≤
- ‚ùå –ù–µ—Ç endpoints –¥–ª—è –æ—Ç–∑—ã–≤–æ–≤

**UI Components: 90%**
- ‚úÖ SouvenirCard
- ‚úÖ ShoppingCart
- ‚úÖ SouvenirCheckout
- ‚ö†Ô∏è SouvenirFilters (–Ω–µ –ø—Ä–æ—á–∏—Ç–∞–Ω)
- ‚ùå Admin panel (–æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç)

**–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª: 60%**
- ‚úÖ –ö–∞—Ç–∞–ª–æ–≥ —Ç–æ–≤–∞—Ä–æ–≤
- ‚úÖ –ö–æ—Ä–∑–∏–Ω–∞
- ‚úÖ –û—Ñ–æ—Ä–º–ª–µ–Ω–∏–µ –∑–∞–∫–∞–∑–∞
- ‚úÖ –§–∏–ª—å—Ç—Ä—ã –∏ —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞
- ‚ö†Ô∏è –ë–µ–∑ persistence
- ‚ùå –ë–µ–∑ payment
- ‚ùå –ë–µ–∑ email
- ‚ùå –ë–µ–∑ admin

**–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å: 20%**
- ‚úÖ Protected route (roles)
- ‚ùå –ù–µ—Ç API auth
- ‚ùå –ù–µ—Ç CSRF
- ‚ùå –ù–µ—Ç rate limiting

**–ò—Ç–æ–≥–æ: 85% –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏**

---

## üéØ 14. ROADMAP

### Phase 1: Database Integration (–ö—Ä–∏—Ç–∏—á–Ω–æ)
- [ ] –ü–æ–¥–∫–ª—é—á–∏—Ç—å PostgreSQL –∫ API
- [ ] –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å CRUD –æ–ø–µ—Ä–∞—Ü–∏–∏ –¥–ª—è souvenirs
- [ ] –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –∫–æ—Ä–∑–∏–Ω—É –≤ –ë–î
- [ ] –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å —Å–æ–∑–¥–∞–Ω–∏–µ –∑–∞–∫–∞–∑–æ–≤
- [ ] –î–æ–±–∞–≤–∏—Ç—å –º–∏–≥—Ä–∞—Ü–∏–∏

**–í—Ä–µ–º—è:** 2-3 –¥–Ω—è  
**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** üî¥ –ö—Ä–∏—Ç–∏—á–Ω–æ

---

### Phase 2: Admin Panel (–í–∞–∂–Ω–æ)
- [ ] –°–æ–∑–¥–∞—Ç—å `/hub/souvenirs-admin` —Å—Ç—Ä–∞–Ω–∏—Ü—É
- [ ] CRUD –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–ª—è —Ç–æ–≤–∞—Ä–æ–≤
- [ ] –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∑–∞–∫–∞–∑–∞–º–∏ (—Å—Ç–∞—Ç—É—Å—ã)
- [ ] –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫—É–ø–æ–Ω–∞–º–∏
- [ ] –ú–æ–¥–µ—Ä–∞—Ü–∏—è –æ—Ç–∑—ã–≤–æ–≤
- [ ] Dashboard —Å–æ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–æ–π

**–í—Ä–µ–º—è:** 3-4 –¥–Ω—è  
**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** üü† –í–∞–∂–Ω–æ

---

### Phase 3: Payment Integration (–í–∞–∂–Ω–æ)
- [ ] –ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞—Ç—å CloudPayments
- [ ] –î–æ–±–∞–≤–∏—Ç—å payment flow
- [ ] –û–±—Ä–∞–±–æ—Ç–∫–∞ webhooks
- [ ] Refund —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª

**–í—Ä–µ–º—è:** 2-3 –¥–Ω—è  
**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** üü† –í–∞–∂–Ω–æ

---

### Phase 4: Notifications (–°—Ä–µ–¥–Ω–µ)
- [ ] Email —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è (—Å–æ–∑–¥–∞–Ω–∏–µ –∑–∞–∫–∞–∑–∞)
- [ ] Email –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è (–æ–ø–ª–∞—Ç–∞)
- [ ] SMS —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è (–æ—Ç–ø—Ä–∞–≤–∫–∞)
- [ ] Telegram bot —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è

**–í—Ä–µ–º—è:** 2 –¥–Ω—è  
**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** üü° –°—Ä–µ–¥–Ω–µ

---

### Phase 5: Enhancements (–ù–∏–∑–∫–æ)
- [ ] –ü–æ–∏—Å–∫ –ø–æ –∫–∞—Ç–∞–ª–æ–≥—É
- [ ] Wishlist (–∏–∑–±—Ä–∞–Ω–Ω–æ–µ)
- [ ] –°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Ç–æ–≤–∞—Ä–æ–≤
- [ ] –°–≤—è–∑–∞–Ω–Ω—ã–µ —Ç–æ–≤–∞—Ä—ã
- [ ] –ò—Å—Ç–æ—Ä–∏—è –ø—Ä–æ—Å–º–æ—Ç—Ä–æ–≤
- [ ] Multi-language

**–í—Ä–µ–º—è:** 5-7 –¥–Ω–µ–π  
**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** üü¢ –ù–∏–∑–∫–æ

---

## üí∞ 15. –ë–ò–ó–ù–ï–°-–ú–û–î–ï–õ–¨

### 15.1 Revenue Streams

**1. –ü—Ä—è–º—ã–µ –ø—Ä–æ–¥–∞–∂–∏:**
- –ú–∞—Ä–∂–∞: 30-50% –Ω–∞ —Å—É–≤–µ–Ω–∏—Ä—ã
- –°—Ä–µ–¥–Ω–∏–π —á–µ–∫: 1000-2000‚ÇΩ
- –ö–æ–Ω–≤–µ—Ä—Å–∏—è: 2-5% (e-commerce —Å—Ç–∞–Ω–¥–∞—Ä—Ç)

**2. –ö–æ–º–∏—Å—Å–∏—è —Å –º–∞—Å—Ç–µ—Ä–æ–≤:**
- –ü–ª–∞—Ç—Ñ–æ—Ä–º–µ–Ω–Ω–∞—è –∫–æ–º–∏—Å—Å–∏—è: 10-15%
- –ó–∞ –∫–∞–∂–¥—É—é –ø—Ä–æ–¥–∞–∂—É —á–µ—Ä–µ–∑ –ø–ª–∞—Ç—Ñ–æ—Ä–º—É

**3. Premium –ª–∏—Å—Ç–∏–Ω–≥:**
- Featured —Ç–æ–≤–∞—Ä—ã: +200‚ÇΩ/–º–µ—Å—è—Ü
- –¢–æ–ø–æ–≤—ã–µ –ø–æ–∑–∏—Ü–∏–∏ –≤ –∫–∞—Ç–∞–ª–æ–≥–µ: +500‚ÇΩ/–º–µ—Å—è—Ü

---

### 15.2 Cost Structure

**Fixed Costs:**
- S3 Storage (–∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è): ~100‚ÇΩ/–º–µ—Å—è—Ü
- Email service: ~300‚ÇΩ/–º–µ—Å—è—Ü

**Variable Costs:**
- Payment processing: 2-3% –æ—Ç —Å—É–º–º—ã
- –î–æ—Å—Ç–∞–≤–∫–∞ (–µ—Å–ª–∏ –Ω–µ —Å–∞–º–æ–≤—ã–≤–æ–∑): 300-500‚ÇΩ

---

### 15.3 Projected Metrics

**–ú–µ—Å—è—á–Ω—ã–π –ø—Ä–æ–≥–Ω–æ–∑ (–ø–æ—Å–ª–µ –∑–∞–ø—É—Å–∫–∞):**
```
–ü–æ—Å–µ—Ç–∏—Ç–µ–ª–µ–π: 1000
–ö–æ–Ω–≤–µ—Ä—Å–∏—è: 3%
–ó–∞–∫–∞–∑–æ–≤: 30
–°—Ä–µ–¥–Ω–∏–π —á–µ–∫: 1500‚ÇΩ
–í—ã—Ä—É—á–∫–∞: 45,000‚ÇΩ
–ú–∞—Ä–∂–∞ (40%): 18,000‚ÇΩ
–ó–∞—Ç—Ä–∞—Ç—ã: 5,000‚ÇΩ
–ü—Ä–∏–±—ã–ª—å: 13,000‚ÇΩ
```

---

## üîç 16. –°–†–ê–í–ù–ï–ù–ò–ï –° –ö–û–ù–ö–£–†–ï–ù–¢–ê–ú–ò

### 16.1 –ú–µ—Å—Ç–Ω—ã–µ –º–∞–≥–∞–∑–∏–Ω—ã

**Kamchatka Souvenirs (offline):**
- ‚ùå –ù–µ—Ç –æ–Ω–ª–∞–π–Ω-–∫–∞—Ç–∞–ª–æ–≥–∞
- ‚ùå –¢–æ–ª—å–∫–æ –æ—Ñ—Ñ–ª–∞–π–Ω
- ‚úÖ –ë–æ–ª—å—à–æ–π –∞—Å—Å–æ—Ä—Ç–∏–º–µ–Ω—Ç

**Kamchatour Hub:**
- ‚úÖ –û–Ω–ª–∞–π–Ω + –æ—Ñ—Ñ–ª–∞–π–Ω
- ‚úÖ –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å —Ç—É—Ä–∞–º–∏
- ‚úÖ –ï–¥–∏–Ω–∞—è —ç–∫–æ—Å–∏—Å—Ç–µ–º–∞

---

### 16.2 –§–µ–¥–µ—Ä–∞–ª—å–Ω—ã–µ –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã

**Wildberries / Ozon:**
- ‚úÖ –û–≥—Ä–æ–º–Ω—ã–π –∞—Å—Å–æ—Ä—Ç–∏–º–µ–Ω—Ç
- ‚úÖ –ë—ã—Å—Ç—Ä–∞—è –¥–æ—Å—Ç–∞–≤–∫–∞
- ‚ùå –ù–µ—Ç —Ñ–æ–∫—É—Å–∞ –Ω–∞ –ö–∞–º—á–∞—Ç–∫–µ
- ‚ùå –ù–µ—Ç —Ç—É—Ä–∏—Å—Ç–∏—á–µ—Å–∫–æ–π –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏

**Kamchatour Hub:**
- ‚úÖ –ö–∞–º—á–∞—Ç—Å–∫–∏–π —Ñ–æ–∫—É—Å
- ‚úÖ –ê—É—Ç–µ–Ω—Ç–∏—á–Ω–æ—Å—Ç—å (–º–µ—Å—Ç–Ω—ã–µ –º–∞—Å—Ç–µ—Ä–∞)
- ‚úÖ –°–≤—è–∑—å —Å —Ç—É—Ä–∞–º–∏
- ‚ö†Ô∏è –ú–µ–Ω—å—à–∏–π –∞—Å—Å–æ—Ä—Ç–∏–º–µ–Ω—Ç

---

## üìà 17. –ú–ï–¢–†–ò–ö–ò –£–°–ü–ï–•–ê

### 17.1 KPIs

**User Acquisition:**
- **Visitors/month:** 1000+
- **Conversion rate:** 3%+
- **Average order value:** 1500‚ÇΩ+

**Engagement:**
- **Time on site:** 5+ minutes
- **Products viewed:** 10+ per visit
- **Cart abandon rate:** <70%

**Business:**
- **Monthly revenue:** 50,000‚ÇΩ+
- **Orders per month:** 30+
- **Repeat customers:** 20%+
- **Customer satisfaction:** 4.5+ stars

---

## üéì 18. LESSONS LEARNED

### 18.1 –ß—Ç–æ —Å–¥–µ–ª–∞–Ω–æ —Ö–æ—Ä–æ—à–æ

‚úÖ **–ü—Ä–æ–¥—É–º–∞–Ω–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Ç–∏–ø–æ–≤**
- 15 TypeScript –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–æ–≤ –æ—Ö–≤–∞—Ç—ã–≤–∞—é—Ç –≤—Å–µ –∫–µ–π—Å—ã
- JSONB –¥–ª—è –≥–∏–±–∫–æ—Å—Ç–∏

‚úÖ **–ü–æ–ª–Ω–æ—Ü–µ–Ω–Ω—ã–π checkout flow**
- 3 —à–∞–≥–∞: catalog ‚Üí cart ‚Üí checkout
- Validation –∏ UX

‚úÖ **–ü—Ä–µ–º–∏–∞–ª—å–Ω—ã–π –¥–∏–∑–∞–π–Ω**
- Black & Gold theme
- Glassmorphism
- Hover —ç—Ñ—Ñ–µ–∫—Ç—ã

---

### 18.2 –ß—Ç–æ –Ω—É–∂–Ω–æ —É–ª—É—á—à–∏—Ç—å

‚ö†Ô∏è **–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –ë–î**
- Mock data ‚Üí PostgreSQL

‚ö†Ô∏è **Admin panel**
- –ù–µ—Ç UI –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è

‚ö†Ô∏è **Payment flow**
- –ù—É–∂–Ω–∞ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è CloudPayments

‚ö†Ô∏è **Persistence**
- –ö–æ—Ä–∑–∏–Ω–∞ –Ω–µ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è

---

## üöÄ 19. NEXT STEPS (–ù–µ–º–µ–¥–ª–µ–Ω–Ω—ã–µ –¥–µ–π—Å—Ç–≤–∏—è)

### Step 1: Fix Critical Issues (1 –Ω–µ–¥–µ–ª—è)

**–î–µ–Ω—å 1-2: Database**
```bash
# 1. –ü—Ä–∏–º–µ–Ω–∏—Ç—å SQL —Å—Ö–µ–º—É
psql $DATABASE_URL < lib/database/souvenirs_schema.sql

# 2. –°–æ–∑–¥–∞—Ç—å seed data
node scripts/seed-souvenirs.ts

# 3. –û–±–Ω–æ–≤–∏—Ç—å API –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –ë–î
```

**–î–µ–Ω—å 3-4: Orders API**
```typescript
// –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å POST /api/souvenirs/orders
export async function POST(request: NextRequest) {
  const { customer, items, delivery } = await request.json();
  
  // 1. –°–æ–∑–¥–∞—Ç—å order –≤ –ë–î
  const order = await createOrder({...});
  
  // 2. –û–±–Ω–æ–≤–∏—Ç—å stock
  await updateStock(items);
  
  // 3. –û—Ç–ø—Ä–∞–≤–∏—Ç—å email
  await sendOrderConfirmation(order);
  
  return NextResponse.json({ success: true, data: order });
}
```

**–î–µ–Ω—å 5: Testing**
- –¢–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –≤–µ—Å—å flow: catalog ‚Üí cart ‚Üí checkout ‚Üí order

---

### Step 2: Admin Panel (1 –Ω–µ–¥–µ–ª—è)

```typescript
// /app/hub/souvenirs-admin/page.tsx

<AdminLayout>
  <Tabs>
    <Tab label="–¢–æ–≤–∞—Ä—ã">
      <SouvenirsCRUD />
    </Tab>
    <Tab label="–ó–∞–∫–∞–∑—ã">
      <OrdersManagement />
    </Tab>
    <Tab label="–ö—É–ø–æ–Ω—ã">
      <CouponsManagement />
    </Tab>
    <Tab label="–û—Ç–∑—ã–≤—ã">
      <ReviewsModeration />
    </Tab>
    <Tab label="–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞">
      <Dashboard />
    </Tab>
  </Tabs>
</AdminLayout>
```

---

### Step 3: Payment (3-5 –¥–Ω–µ–π)

```typescript
// –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è CloudPayments
import { CloudPayments } from '@/lib/payment';

const payment = await CloudPayments.charge({
  amount: totalPrice,
  currency: 'RUB',
  description: `–ó–∞–∫–∞–∑ #${orderNumber}`,
  accountId: customer.email
});

if (payment.success) {
  await updateOrderStatus(orderId, 'paid');
  await sendOrderConfirmation(order);
}
```

---

## üéâ 20. –ó–ê–ö–õ–Æ–ß–ï–ù–ò–ï

### –ò—Ç–æ–≥–æ–≤–∞—è –æ—Ü–µ–Ω–∫–∞ –º–æ–¥—É–ª—è

**–û—Ü–µ–Ω–∫–∞: 8/10** ‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê‚òÜ‚òÜ

**–°–∏–ª—å–Ω—ã–µ —Å—Ç–æ—Ä–æ–Ω—ã:**
- ‚úÖ –ü–æ–ª–Ω–∞—è —Ç–∏–ø–∏–∑–∞—Ü–∏—è (15 –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–æ–≤)
- ‚úÖ –ü—Ä–æ–¥—É–º–∞–Ω–Ω–∞—è SQL —Å—Ö–µ–º–∞ (6 —Ç–∞–±–ª–∏—Ü)
- ‚úÖ –ö–∞—á–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ UI –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã
- ‚úÖ –ü—Ä–µ–º–∏–∞–ª—å–Ω—ã–π –¥–∏–∑–∞–π–Ω
- ‚úÖ –õ–æ–≥–∏—á–Ω—ã–π UX flow

**–°–ª–∞–±—ã–µ —Å—Ç–æ—Ä–æ–Ω—ã:**
- ‚ùå Mock data –≤–º–µ—Å—Ç–æ —Ä–µ–∞–ª—å–Ω–æ–π –ë–î
- ‚ùå –ù–µ–ø–æ–ª–Ω—ã–π API (orders –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç)
- ‚ùå –ù–µ—Ç admin –ø–∞–Ω–µ–ª–∏
- ‚ùå –ù–µ—Ç payment –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏
- ‚ùå –ù–µ—Ç persistence –∫–æ—Ä–∑–∏–Ω—ã

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:**
–ú–æ–¥—É–ª—å **–≥–æ—Ç–æ–≤ –∫ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ –Ω–∞ 85%**, –Ω–æ **–Ω–µ –≥–æ—Ç–æ–≤ –∫ –ø—Ä–æ–¥–∞–∫—à–µ–Ω—É** –±–µ–∑:
1. –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ —Å PostgreSQL
2. –†–µ–∞–ª–∏–∑–∞—Ü–∏–∏ orders API
3. Admin –ø–∞–Ω–µ–ª–∏
4. Payment flow

**ETA –¥–æ –ø—Ä–æ–¥–∞–∫—à–Ω-ready:** 2-3 –Ω–µ–¥–µ–ª–∏

---

**–ü–æ—Å–ª–µ–¥–Ω—è—è –≤–µ—Ç–∫–∞:** `cursor/bc-6746a212-ca75-4653-b1b4-40c07270c0d2-614b` (—Ç–µ–∫—É—â–∞—è)  
**–ü–æ—Å–ª–µ–¥–Ω–∏–π –∫–æ–º–º–∏—Ç:** `2e00615` - "feat: Add Kamchatour Hub analysis and homepage design"

**–î–∞—Ç–∞ –∞–Ω–∞–ª–∏–∑–∞:** 2025-11-12  
**–ê–≤—Ç–æ—Ä:** AI Assistant  
**–í–µ—Ä—Å–∏—è:** 1.0 - Complete Analysis

---

## üìé –ü–†–ò–õ–û–ñ–ï–ù–ò–Ø

### A. Quick Reference

**–û—Å–Ω–æ–≤–Ω—ã–µ —Ñ–∞–π–ª—ã:**
- `/types/souvenirs.ts` - –¢–∏–ø—ã (376 —Å—Ç—Ä–æ–∫)
- `/app/hub/souvenirs/page.tsx` - UI (268 —Å—Ç—Ä–æ–∫)
- `/app/api/souvenirs/route.ts` - API (167 —Å—Ç—Ä–æ–∫)
- `/lib/database/souvenirs_schema.sql` - SQL (145 —Å—Ç—Ä–æ–∫)

**–ö–ª—é—á–µ–≤—ã–µ —Å—É—â–Ω–æ—Å—Ç–∏:**
- Souvenir (—Ç–æ–≤–∞—Ä)
- ShoppingCart (–∫–æ—Ä–∑–∏–Ω–∞)
- SouvenirOrder (–∑–∞–∫–∞–∑)
- ProductReview (–æ—Ç–∑—ã–≤)
- Coupon (–∫—É–ø–æ–Ω)

**API Endpoints:**
- GET `/api/souvenirs` (‚úÖ —Ä–∞–±–æ—Ç–∞–µ—Ç)
- POST `/api/souvenirs` (‚úÖ —Ä–∞–±–æ—Ç–∞–µ—Ç)
- POST `/api/souvenirs/orders` (‚ùå –Ω–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω)

**UI Components:**
- SouvenirCard (53 —Å—Ç—Ä–æ–∫–∏)
- ShoppingCart (119 —Å—Ç—Ä–æ–∫)
- SouvenirCheckout (296 —Å—Ç—Ä–æ–∫)
- SouvenirFilters (???)

**–ì–æ—Ç–æ–≤–Ω–æ—Å—Ç—å: 85%**

---

## üìß –ö–û–ù–¢–ê–ö–¢–´ –î–õ–Ø –í–û–ü–†–û–°–û–í

–ï—Å–ª–∏ –µ—Å—Ç—å –≤–æ–ø—Ä–æ—Å—ã –ø–æ –º–æ–¥—É–ª—é —Å—É–≤–µ–Ω–∏—Ä–æ–≤:
- –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è: `/workspace/SOUVENIRS_MODULE_COMPLETE_ANALYSIS.md`
- Types: `/workspace/types/souvenirs.ts`
- SQL: `/workspace/lib/database/souvenirs_schema.sql`

**–ì–æ—Ç–æ–≤–æ –∫ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ!** üöÄ
