# üóÑÔ∏è –ò–ù–°–¢–†–£–ö–¶–ò–Ø: –ù–ê–°–¢–†–û–ô–ö–ê –ë–î –ù–ê TIMEWEB CLOUD

**–î–∞—Ç–∞:** 7 –Ω–æ—è–±—Ä—è 2025  
**–ü–ª–∞—Ç—Ñ–æ—Ä–º–∞:** [Timeweb Cloud](https://timeweb.cloud/)

---

## üéØ –®–ê–ì 1: –°–û–ó–î–ê–ù–ò–ï –ë–î –ù–ê TIMEWEB CLOUD

### –í–∞—Ä–∏–∞–Ω—Ç A: –ß–µ—Ä–µ–∑ –≤–µ–±-–ø–∞–Ω–µ–ª—å (–†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)

1. **–í–æ–π—Ç–∏ –≤ –ø–∞–Ω–µ–ª—å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è:**
   ```
   https://timeweb.cloud/
   –ê–∫–∫–∞—É–Ω—Ç: pa422108
   ```

2. **–ü–µ—Ä–µ–π—Ç–∏ –∫ —Å–æ–∑–¥–∞–Ω–∏—é –ë–î:**
   ```
   –ì–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é ‚Üí –°–µ—Ä–≤–∏—Å—ã ‚Üí –û–±–ª–∞—á–Ω—ã–µ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö ‚Üí –°–æ–∑–¥–∞—Ç—å –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö
   ```

3. **–í—ã–±—Ä–∞—Ç—å –ø–∞—Ä–∞–º–µ—Ç—Ä—ã:**
   ```
   –°–£–ë–î:          PostgreSQL 15 –∏–ª–∏ 16
   –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è:  –ë–∞–∑–æ–≤–∞—è (1 CPU, 2 GB RAM) - –¥–ª—è —Å—Ç–∞—Ä—Ç–∞
   –†–µ–≥–∏–æ–Ω:        ru-1 (–†–æ—Å—Å–∏—è)
   –ò–º—è –±–∞–∑—ã:      kamhub
   –õ–æ–≥–∏–Ω:         kamhub_admin (–∏–ª–∏ –ª—é–±–æ–π –¥—Ä—É–≥–æ–π)
   –ü–∞—Ä–æ–ª—å:        [–±—É–¥–µ—Ç —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ - –°–û–•–†–ê–ù–ò–¢–ï –ï–ì–û!]
   ```

4. **–î–æ–∂–¥–∞—Ç—å—Å—è —Å–æ–∑–¥–∞–Ω–∏—è (~3-5 –º–∏–Ω—É—Ç)**

5. **–ü–æ–ª—É—á–∏—Ç—å –¥–∞–Ω–Ω—ã–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è:**
   –ü–æ—Å–ª–µ —Å–æ–∑–¥–∞–Ω–∏—è –≤—ã –ø–æ–ª—É—á–∏—Ç–µ:
   ```
   Host:     xxx-xxx.timeweb.cloud (–∏–ª–∏ IP –∞–¥—Ä–µ—Å)
   Port:     5432
   Database: kamhub
   Username: kamhub_admin
   Password: [—Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –ø–∞—Ä–æ–ª—å]
   ```

---

## üîß –®–ê–ì 2: –ù–ê–°–¢–†–û–ô–ö–ê –ü–†–ò–õ–û–ñ–ï–ù–ò–Ø

### 1. –°–æ–∑–¥–∞—Ç—å —Ñ–∞–π–ª .env

–í –∫–æ—Ä–Ω–µ –ø—Ä–æ–µ–∫—Ç–∞ —Å–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª `.env`:

```bash
# –°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–∏–º–µ—Ä
cp .env.example .env
```

### 2. –í—Å—Ç–∞–≤–∏—Ç—å DATABASE_URL

–û—Ç–∫—Ä–æ–π—Ç–µ `.env` –∏ –¥–æ–±–∞–≤—å—Ç–µ —Å—Ç—Ä–æ–∫—É –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è:

```env
# –§–û–†–ú–ê–¢:
DATABASE_URL=postgresql://USERNAME:PASSWORD@HOST:PORT/DATABASE

# –ü–†–ò–ú–ï–† —Å —Ä–µ–∞–ª—å–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏ –æ—Ç Timeweb:
DATABASE_URL=postgresql://kamhub_admin:Xy8$mK2pQ9vL@db-12345.timeweb.cloud:5432/kamhub

# –î–ª—è production –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ SSL:
DATABASE_SSL=true
```

### 3. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ

```bash
# –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –µ—Å–ª–∏ –µ—â–µ –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã
npm install

# –°–æ–∑–¥–∞—Ç—å —Ç–µ—Å—Ç–æ–≤—ã–π —Å–∫—Ä–∏–ø—Ç
cat > test-db.js << 'EOF'
const { Pool } = require('pg');
require('dotenv').config();

const pool = new Pool({
  connectionString: process.env.DATABASE_URL,
  ssl: process.env.DATABASE_SSL === 'true' ? { rejectUnauthorized: false } : false
});

async function test() {
  try {
    const client = await pool.connect();
    console.log('‚úÖ –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ —É—Å–ø–µ—à–Ω–æ!');
    const res = await client.query('SELECT version()');
    console.log('üìä PostgreSQL:', res.rows[0].version.split(',')[0]);
    client.release();
    await pool.end();
  } catch (err) {
    console.error('‚ùå –û—à–∏–±–∫–∞:', err.message);
    process.exit(1);
  }
}

test();
EOF

# –ó–∞–ø—É—Å—Ç–∏—Ç—å —Ç–µ—Å—Ç
node test-db.js
```

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:**
```
‚úÖ –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ —É—Å–ø–µ—à–Ω–æ!
üìä PostgreSQL: PostgreSQL 15.x
```

---

## üìã –®–ê–ì 3: –ü–†–ò–ú–ï–ù–ï–ù–ò–ï –°–•–ï–ú–´ –ë–î

### –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)

```bash
# –ü—Ä–∏–º–µ–Ω–∏—Ç—å –≤—Å–µ —Å—Ö–µ–º—ã –æ–¥–Ω–æ–π –∫–æ–º–∞–Ω–¥–æ–π
bash scripts/apply-all-schemas.sh
```

### –í—Ä—É—á–Ω—É—é (–µ—Å–ª–∏ –Ω—É–∂–µ–Ω –∫–æ–Ω—Ç—Ä–æ–ª—å)

```bash
# –ü–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è –∫ –ë–î —á–µ—Ä–µ–∑ psql
psql "postgresql://kamhub_admin:YOUR_PASSWORD@db-xxx.timeweb.cloud:5432/kamhub"

# –ü—Ä–∏–º–µ–Ω–∏—Ç—å —Å—Ö–µ–º—ã –ø–æ –æ—á–µ—Ä–µ–¥–∏
\i scripts/schemas/01-core-tables.sql
\i scripts/schemas/02-auth-tables.sql
\i scripts/schemas/03-tour-tables.sql
\i scripts/schemas/04-booking-tables.sql
\i scripts/schemas/05-payment-tables.sql
\i scripts/schemas/06-review-tables.sql
\i scripts/schemas/07-partner-tables.sql
\i scripts/schemas/08-transfer-tables.sql
\i scripts/schemas/09-accommodation-tables.sql
\i scripts/schemas/10-gear-rental-tables.sql
\i scripts/schemas/11-car-rental-tables.sql
\i scripts/schemas/12-souvenir-tables.sql
\i scripts/schemas/13-notification-tables.sql
\i scripts/schemas/14-analytics-tables.sql

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å–æ–∑–¥–∞–Ω–Ω—ã–µ —Ç–∞–±–ª–∏—Ü—ã
\dt

# –í—ã–π—Ç–∏
\q
```

---

## üîç –®–ê–ì 4: –ü–†–û–í–ï–†–ö–ê

### 1. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ç–∞–±–ª–∏—Ü—ã

```bash
# SQL –∑–∞–ø—Ä–æ—Å –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏
psql $DATABASE_URL -c "SELECT table_name FROM information_schema.tables WHERE table_schema='public' ORDER BY table_name;"
```

–î–æ–ª–∂–Ω–æ –±—ã—Ç—å –ø—Ä–∏–º–µ—Ä–Ω–æ 25-30 —Ç–∞–±–ª–∏—Ü.

### 2. –ó–∞–ø—É—Å—Ç–∏—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ

```bash
# Development
npm run dev

# Production
npm run build
npm start
```

### 3. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å API

–û—Ç–∫—Ä–æ–π—Ç–µ –±—Ä–∞—É–∑–µ—Ä:
```
http://localhost:3000/api/health
```

–î–æ–ª–∂–µ–Ω –≤–µ—Ä–Ω—É—Ç—å:
```json
{
  "status": "healthy",
  "database": "connected",
  "timestamp": "2025-11-07T..."
}
```

---

## üîê –ë–ï–ó–û–ü–ê–°–ù–û–°–¢–¨

### 1. –ù–∞—Å—Ç—Ä–æ–∏—Ç—å Whitelist IP

–í –ø–∞–Ω–µ–ª–∏ Timeweb Cloud:
```
–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö ‚Üí –ù–∞—Å—Ç—Ä–æ–π–∫–∏ ‚Üí –†–∞–∑—Ä–µ—à–µ–Ω–Ω—ã–µ IP –∞–¥—Ä–µ—Å–∞
–î–æ–±–∞–≤–∏—Ç—å: 5.129.248.224 (–≤–∞—à —Å–µ—Ä–≤–µ—Ä)
```

### 2. SSL –æ–±—è–∑–∞—Ç–µ–ª–µ–Ω –≤ production

```env
DATABASE_SSL=true
```

### 3. –°–ª–æ–∂–Ω—ã–π –ø–∞—Ä–æ–ª—å

–ú–∏–Ω–∏–º—É–º:
- 16 —Å–∏–º–≤–æ–ª–æ–≤
- –ó–∞–≥–ª–∞–≤–Ω—ã–µ –∏ —Å—Ç—Ä–æ—á–Ω—ã–µ –±—É–∫–≤—ã
- –¶–∏—Ñ—Ä—ã
- –°–ø–µ—Ü—Å–∏–º–≤–æ–ª—ã

### 4. –ù–µ –∫–æ–º–º–∏—Ç–∏—Ç—å .env!

–£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ `.env` –≤ `.gitignore`:
```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å
cat .gitignore | grep ".env"

# –ï—Å–ª–∏ –Ω–µ—Ç - –¥–æ–±–∞–≤–∏—Ç—å
echo ".env" >> .gitignore
echo ".env.local" >> .gitignore
echo ".env.production" >> .gitignore
```

---

## üö® –†–ï–®–ï–ù–ò–ï –ü–†–û–ë–õ–ï–ú

### –û—à–∏–±–∫–∞: "ENOTFOUND"

**–ü—Ä–∏—á–∏–Ω–∞:** –ù–µ–≤–µ—Ä–Ω—ã–π —Ö–æ—Å—Ç

**–†–µ—à–µ–Ω–∏–µ:**
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ HOST –≤ DATABASE_URL
2. –°–∫–æ–ø–∏—Ä—É–π—Ç–µ —Ç–æ—á–Ω—ã–π –∞–¥—Ä–µ—Å –∏–∑ –ø–∞–Ω–µ–ª–∏ Timeweb
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ DNS: `nslookup db-xxx.timeweb.cloud`

---

### –û—à–∏–±–∫–∞: "ECONNREFUSED"

**–ü—Ä–∏—á–∏–Ω–∞:** –ë–î –Ω–µ –∑–∞–ø—É—â–µ–Ω–∞ –∏–ª–∏ –Ω–µ–≤–µ—Ä–Ω—ã–π –ø–æ—Ä—Ç

**–†–µ—à–µ–Ω–∏–µ:**
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å—Ç–∞—Ç—É—Å –ë–î –≤ –ø–∞–Ω–µ–ª–∏ Timeweb
2. –£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ –ø–æ—Ä—Ç 5432
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ firewall

---

### –û—à–∏–±–∫–∞: "28P01 password authentication failed"

**–ü—Ä–∏—á–∏–Ω–∞:** –ù–µ–≤–µ—Ä–Ω—ã–π –ø–∞—Ä–æ–ª—å

**–†–µ—à–µ–Ω–∏–µ:**
1. –ü–µ—Ä–µ–ø—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–∞—Ä–æ–ª—å –≤ DATABASE_URL
2. –£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ –Ω–µ—Ç –ª–∏—à–Ω–∏—Ö –ø—Ä–æ–±–µ–ª–æ–≤
3. –ï—Å–ª–∏ –∑–∞–±—ã–ª–∏ –ø–∞—Ä–æ–ª—å - —Å–±—Ä–æ—Å—å—Ç–µ –≤ –ø–∞–Ω–µ–ª–∏ Timeweb

---

### –û—à–∏–±–∫–∞: "database does not exist"

**–ü—Ä–∏—á–∏–Ω–∞:** –ë–∞–∑–∞ –Ω–µ —Å–æ–∑–¥–∞–Ω–∞

**–†–µ—à–µ–Ω–∏–µ:**
1. –°–æ–∑–¥–∞–π—Ç–µ –ë–î —á–µ—Ä–µ–∑ –ø–∞–Ω–µ–ª—å Timeweb Cloud
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∏–º—è –≤ DATABASE_URL

---

### –û—à–∏–±–∫–∞: "SSL connection required"

**–ü—Ä–∏—á–∏–Ω–∞:** Timeweb —Ç—Ä–µ–±—É–µ—Ç SSL –≤ production

**–†–µ—à–µ–Ω–∏–µ:**
```env
DATABASE_SSL=true
```

---

## üìä –ú–û–ù–ò–¢–û–†–ò–ù–ì

### –ß–µ—Ä–µ–∑ –ø–∞–Ω–µ–ª—å Timeweb

```
–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö ‚Üí –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥
```

–î–æ—Å—Ç—É–ø–Ω–æ:
- CPU usage
- Memory usage
- Disk usage
- Connections count
- Query performance

### –ß–µ—Ä–µ–∑ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ

```javascript
// –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∞–∫—Ç–∏–≤–Ω—ã–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è
const pool = getPool();
console.log('Total connections:', pool.totalCount);
console.log('Idle connections:', pool.idleCount);
console.log('Waiting requests:', pool.waitingCount);
```

---

## ‚úÖ –ß–ï–ö–õ–ò–°–¢ –ì–û–¢–û–í–ù–û–°–¢–ò

- [ ] –ë–î —Å–æ–∑–¥–∞–Ω–∞ –Ω–∞ Timeweb Cloud
- [ ] DATABASE_URL –¥–æ–±–∞–≤–ª–µ–Ω –≤ .env
- [ ] –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–æ
- [ ] –°—Ö–µ–º—ã –ë–î –ø—Ä–∏–º–µ–Ω–µ–Ω—ã
- [ ] –¢–∞–±–ª–∏—Ü—ã —Å–æ–∑–¥–∞–Ω—ã (25-30 —à—Ç—É–∫)
- [ ] SSL –≤–∫–ª—é—á–µ–Ω –¥–ª—è production
- [ ] Whitelist IP –Ω–∞—Å—Ç—Ä–æ–µ–Ω
- [ ] .env –≤ .gitignore
- [ ] –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è
- [ ] API endpoints —Ä–∞–±–æ—Ç–∞—é—Ç

---

## üéâ –ì–û–¢–û–í–û!

–ü–æ—Å–ª–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –≤—Å–µ—Ö —à–∞–≥–æ–≤ –≤–∞—à–∞ –ë–î –≥–æ—Ç–æ–≤–∞ –∫ —Ä–∞–±–æ—Ç–µ!

**–°–ª–µ–¥—É—é—â–∏–π —à–∞–≥:** –ó–∞–≥—Ä—É–∑–∫–∞ –Ω–∞—á–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö (seed data)

```bash
# –ï—Å–ª–∏ –µ—Å—Ç—å —Å–∫—Ä–∏–ø—Ç seed
node scripts/seed-database.js
```

---

**–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è Timeweb Cloud:** https://timeweb.cloud/  
**–ü–æ–¥–¥–µ—Ä–∂–∫–∞:** 8 (800) 700-32-92





